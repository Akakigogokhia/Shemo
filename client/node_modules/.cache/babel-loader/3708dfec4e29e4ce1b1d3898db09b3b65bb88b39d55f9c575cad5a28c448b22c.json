{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import{useEffect,useState}from'react';import useFetch from'../../hooks/useFetch';import'./chatOnline.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ChatOnline(_ref){var onlineUsers=_ref.onlineUsers,currentId=_ref.currentId,setCurrentChat=_ref.setCurrentChat,user=_ref.user;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),friends=_useState2[0],setFriends=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),suggestedFriends=_useState4[0],setSuggestedFriends=_useState4[1];var _useFetch=useFetch('/users/all'),users=_useFetch.data;var PF=process.env.REACT_APP_PUBLIC_FOLDER;useEffect(function(){setSuggestedFriends(users.filter(function(u){return!user.followings.includes(u._id)&&user._id!==u._id;}));},[users]);var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(friend){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/conversations/find/\".concat(currentId,\"/\").concat(friend._id));case 3:res=_context.sent;if(res.data){_context.next=13;break;}_context.prev=5;_context.next=8;return axios.post('/conversations',{senderId:currentId,receiverId:friend._id});case 8:res=_context.sent;_context.next=13;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](5);case 13:setCurrentChat(res.data);_context.next=18;break;case 16:_context.prev=16;_context.t1=_context[\"catch\"](0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,16],[5,11]]);}));return function handleClick(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){var getFriends=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/users/friends/'+currentId);case 2:res=_context2.sent;setFriends(res.data);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function getFriends(){return _ref3.apply(this,arguments);};}();getFriends();},[currentId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"chatOnline\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"friendType\",children:\"Friends\"}),friends.map(function(friend){return/*#__PURE__*/_jsxs(\"div\",{className:\"chatOnlineFriend\",onClick:function onClick(){return handleClick(friend);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chatOnlineImgContainer\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"chatOnlineImg\",src:friend!==null&&friend!==void 0&&friend.profilePicture?PF+(friend===null||friend===void 0?void 0:friend.profilePicture):PF+'person/noAvatar.png'}),onlineUsers.some(function(u){return u.userId===friend._id;})&&/*#__PURE__*/_jsx(\"div\",{className:\"chatOnlineBadge1\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chatOnlineName\",children:friend.username})]},friend._id);}),/*#__PURE__*/_jsx(\"p\",{className:\"friendType\",children:\"Suggested Friends\"}),suggestedFriends.map(function(friend){return/*#__PURE__*/_jsxs(\"div\",{className:\"chatOnlineFriend\",onClick:function onClick(){return handleClick(friend);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chatOnlineImgContainer\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"chatOnlineImg\",src:friend!==null&&friend!==void 0&&friend.profilePicture?PF+(friend===null||friend===void 0?void 0:friend.profilePicture):PF+'person/noAvatar.png'}),onlineUsers.some(function(u){return u.userId===friend._id;})&&/*#__PURE__*/_jsx(\"div\",{className:\"chatOnlineBadge1\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chatOnlineName\",children:friend.username})]},friend._id);})]});}export default ChatOnline;","map":{"version":3,"names":["axios","useEffect","useState","useFetch","ChatOnline","onlineUsers","currentId","setCurrentChat","user","friends","setFriends","suggestedFriends","setSuggestedFriends","users","data","PF","process","env","REACT_APP_PUBLIC_FOLDER","filter","u","followings","includes","_id","handleClick","friend","get","res","post","senderId","receiverId","getFriends","map","profilePicture","some","userId","username"],"sources":["C:/Users/AKAKI/SocialMedia/client/src/components/chatOnline/ChatOnline.jsx"],"sourcesContent":["import axios from 'axios';\r\nimport { useEffect, useState } from 'react';\r\nimport useFetch from '../../hooks/useFetch';\r\nimport './chatOnline.css';\r\n\r\nfunction ChatOnline({ onlineUsers, currentId, setCurrentChat, user }) {\r\n  const [friends, setFriends] = useState([]);\r\n  const [suggestedFriends, setSuggestedFriends] = useState([]);\r\n  const { data: users } = useFetch('/users/all');\r\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\r\n\r\n  useEffect(() => {\r\n    setSuggestedFriends(\r\n      users.filter(\r\n        (u) => !user.followings.includes(u._id) && user._id !== u._id\r\n      )\r\n    );\r\n  }, [users]);\r\n\r\n  const handleClick = async (friend) => {\r\n    let res;\r\n    try {\r\n      res = await axios.get(`/conversations/find/${currentId}/${friend._id}`);\r\n      if (!res.data) {\r\n        try {\r\n          res = await axios.post('/conversations', {\r\n            senderId: currentId,\r\n            receiverId: friend._id,\r\n          });\r\n        } catch (error) {}\r\n      }\r\n      setCurrentChat(res.data);\r\n    } catch (error) {}\r\n  };\r\n\r\n  useEffect(() => {\r\n    const getFriends = async () => {\r\n      const res = await axios.get('/users/friends/' + currentId);\r\n      setFriends(res.data);\r\n    };\r\n    getFriends();\r\n  }, [currentId]);\r\n\r\n  return (\r\n    <div className='chatOnline'>\r\n      <p className='friendType'>Friends</p>\r\n      {friends.map((friend) => (\r\n        <div\r\n          className='chatOnlineFriend'\r\n          onClick={() => handleClick(friend)}\r\n          key={friend._id}\r\n        >\r\n          <div className='chatOnlineImgContainer'>\r\n            <img\r\n              className='chatOnlineImg'\r\n              src={\r\n                friend?.profilePicture\r\n                  ? PF + friend?.profilePicture\r\n                  : PF + 'person/noAvatar.png'\r\n              }\r\n            />\r\n            {onlineUsers.some((u) => u.userId === friend._id) && (\r\n              <div className='chatOnlineBadge1'></div>\r\n            )}\r\n          </div>\r\n          <div className='chatOnlineName'>{friend.username}</div>\r\n        </div>\r\n      ))}\r\n      <p className='friendType'>Suggested Friends</p>\r\n      {suggestedFriends.map((friend) => (\r\n        <div\r\n          className='chatOnlineFriend'\r\n          onClick={() => handleClick(friend)}\r\n          key={friend._id}\r\n        >\r\n          <div className='chatOnlineImgContainer'>\r\n            <img\r\n              className='chatOnlineImg'\r\n              src={\r\n                friend?.profilePicture\r\n                  ? PF + friend?.profilePicture\r\n                  : PF + 'person/noAvatar.png'\r\n              }\r\n            />\r\n\r\n            {onlineUsers.some((u) => u.userId === friend._id) && (\r\n              <div className='chatOnlineBadge1'></div>\r\n            )}\r\n          </div>\r\n          <div className='chatOnlineName'>{friend.username}</div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatOnline;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}