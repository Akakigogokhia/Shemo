{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./post.css';import MoreVertIcon from'@mui/icons-material/MoreVert';import{Users}from'../../dummyData';import{useEffect,useState}from'react';import useFetch from'../../hooks/useFetch';import{format}from'timeago.js';import{Link}from'react-router-dom';import axios from'axios';import{useContext}from'react';import{AuthContext}from'../../context/AuthContext';import DeleteSweepIcon from'@mui/icons-material/DeleteSweep';import ThumbUpOutlinedIcon from'@mui/icons-material/ThumbUpOutlined';import ThumbUpIcon from'@mui/icons-material/ThumbUp';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Post(_ref){var post=_ref.post;var _useState=useState(post),_useState2=_slicedToArray(_useState,2),desc=_useState2[0],setDesc=_useState2[1];var _useState3=useState(post.likes.length),_useState4=_slicedToArray(_useState3,2),like=_useState4[0],setLike=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLiked=_useState6[0],setIsLiked=_useState6[1];var PF=process.env.REACT_APP_PUBLIC_FOLDER;var _useContext=useContext(AuthContext),currentUser=_useContext.user;useEffect(function(){setIsLiked(post.likes.includes(currentUser._id));},[currentUser._id,post.likes]);var _useFetch=useFetch(\"/users?userId=\".concat(post.userId)),data=_useFetch.data,loading=_useFetch.loading,error=_useFetch.error;var likeHandler=function likeHandler(){try{axios.put('/posts/'+post._id+'/like',{userId:currentUser._id});}catch(err){}setLike(isLiked?like-1:like+1);setIsLiked(!isLiked);};var deletePost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.delete('/posts/'+post._id,{data:{userId:currentUser._id}});case 3:res=_context.sent;console.log(res);setDesc(null);_context.next=10;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function deletePost(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"post\",children:desc?loading?'please wait':/*#__PURE__*/_jsxs(\"div\",{className:\"postWrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTop\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTopLeft\",children:[/*#__PURE__*/_jsx(Link,{to:\"profile/\".concat(data.username),children:/*#__PURE__*/_jsx(\"img\",{className:\"postProfileImg\",src:data.profilePicture?PF+data.profilePicture:PF+'person/noAvatar.png',alt:\"\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"postUsername\",children:data.username}),/*#__PURE__*/_jsx(\"span\",{className:\"postDate\",children:format(desc.createdAt)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postTopRight\",children:desc.userId!==currentUser._id?/*#__PURE__*/_jsx(MoreVertIcon,{}):/*#__PURE__*/_jsx(DeleteSweepIcon,{onClick:deletePost,style:{cursor:'pointer'}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postCenter\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"postText\",children:desc===null||desc===void 0?void 0:desc.desc}),/*#__PURE__*/_jsx(\"img\",{className:\"postImg\",src:PF+(desc===null||desc===void 0?void 0:desc.img),alt:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postBottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postBottomLeft\",children:[isLiked?/*#__PURE__*/_jsx(ThumbUpIcon,{className:\"likeIcon\",onClick:likeHandler}):/*#__PURE__*/_jsx(ThumbUpOutlinedIcon,{className:\"likeIcon\",onClick:likeHandler}),/*#__PURE__*/_jsxs(\"span\",{className:\"postLikeCounter\",children:[like,\" people like it\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postBottomRight\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"postCommentText\",children:[desc===null||desc===void 0?void 0:desc.comment,\" comments\"]})})]})]}):/*#__PURE__*/_jsx(\"div\",{children:\"This post has been deleted...\"})});}","map":{"version":3,"names":["MoreVertIcon","Users","useEffect","useState","useFetch","format","Link","axios","useContext","AuthContext","DeleteSweepIcon","ThumbUpOutlinedIcon","ThumbUpIcon","Post","post","desc","setDesc","likes","length","like","setLike","isLiked","setIsLiked","PF","process","env","REACT_APP_PUBLIC_FOLDER","currentUser","user","includes","_id","userId","data","loading","error","likeHandler","put","err","deletePost","delete","res","console","log","username","profilePicture","createdAt","cursor","img","comment"],"sources":["C:/Users/AKAKI/SocialMedia/client/src/components/post/Post.jsx"],"sourcesContent":["import './post.css';\r\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\r\nimport { Users } from '../../dummyData';\r\nimport { useEffect, useState } from 'react';\r\nimport useFetch from '../../hooks/useFetch';\r\nimport { format } from 'timeago.js';\r\nimport { Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useContext } from 'react';\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport DeleteSweepIcon from '@mui/icons-material/DeleteSweep';\r\nimport ThumbUpOutlinedIcon from '@mui/icons-material/ThumbUpOutlined';\r\nimport ThumbUpIcon from '@mui/icons-material/ThumbUp';\r\n\r\nexport default function Post({ post }) {\r\n  const [desc, setDesc] = useState(post);\r\n  const [like, setLike] = useState(post.likes.length);\r\n  const [isLiked, setIsLiked] = useState(false);\r\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\r\n  const { user: currentUser } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    setIsLiked(post.likes.includes(currentUser._id));\r\n  }, [currentUser._id, post.likes]);\r\n\r\n  const { data, loading, error } = useFetch(`/users?userId=${post.userId}`);\r\n\r\n  const likeHandler = () => {\r\n    try {\r\n      axios.put('/posts/' + post._id + '/like', { userId: currentUser._id });\r\n    } catch (err) {}\r\n    setLike(isLiked ? like - 1 : like + 1);\r\n    setIsLiked(!isLiked);\r\n  };\r\n\r\n  const deletePost = async () => {\r\n    try {\r\n      const res = await axios.delete('/posts/' + post._id, {\r\n        data: { userId: currentUser._id },\r\n      });\r\n      console.log(res);\r\n      setDesc(null);\r\n    } catch (error) {}\r\n  };\r\n\r\n  return (\r\n    <div className='post'>\r\n      {desc ? (\r\n        loading ? (\r\n          'please wait'\r\n        ) : (\r\n          <div className='postWrapper'>\r\n            <div className='postTop'>\r\n              <div className='postTopLeft'>\r\n                <Link to={`profile/${data.username}`}>\r\n                  <img\r\n                    className='postProfileImg'\r\n                    src={\r\n                      data.profilePicture\r\n                        ? PF + data.profilePicture\r\n                        : PF + 'person/noAvatar.png'\r\n                    }\r\n                    alt=''\r\n                  />\r\n                </Link>\r\n                <span className='postUsername'>{data.username}</span>\r\n                <span className='postDate'>{format(desc.createdAt)}</span>\r\n              </div>\r\n              <div className='postTopRight'>\r\n                {desc.userId !== currentUser._id ? (\r\n                  <MoreVertIcon />\r\n                ) : (\r\n                  <DeleteSweepIcon\r\n                    onClick={deletePost}\r\n                    style={{ cursor: 'pointer' }}\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className='postCenter'>\r\n              <span className='postText'>{desc?.desc}</span>\r\n              <img className='postImg' src={PF + desc?.img} alt='' />\r\n            </div>\r\n            <div className='postBottom'>\r\n              <div className='postBottomLeft'>\r\n                {isLiked ? (\r\n                  <ThumbUpIcon className='likeIcon' onClick={likeHandler} />\r\n                ) : (\r\n                  <ThumbUpOutlinedIcon\r\n                    className='likeIcon'\r\n                    onClick={likeHandler}\r\n                  />\r\n                )}\r\n\r\n                <span className='postLikeCounter'>{like} people like it</span>\r\n              </div>\r\n              <div className='postBottomRight'>\r\n                <span className='postCommentText'>\r\n                  {desc?.comment} comments\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )\r\n      ) : (\r\n        <div>This post has been deleted...</div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}