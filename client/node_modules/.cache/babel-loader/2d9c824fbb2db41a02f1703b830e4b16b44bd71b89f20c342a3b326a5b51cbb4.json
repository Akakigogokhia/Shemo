{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/AKAKI/SocialMedia/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./rightbar.css';import Online from'../online/Online';import{useContext,useEffect,useRef,useState}from'react';import axios from'axios';import{Link}from'react-router-dom';import{AuthContext}from'../../context/AuthContext';import AddIcon from'@mui/icons-material/Add';import RemoveIcon from'@mui/icons-material/Remove';import{io}from'socket.io-client';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Rightbar(_ref){var user=_ref.user;var PF=process.env.REACT_APP_PUBLIC_FOLDER;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),friends=_useState2[0],setFriends=_useState2[1];var _useContext=useContext(AuthContext),currentUser=_useContext.user,dispatch=_useContext.dispatch;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),followed=_useState4[0],setFollowed=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),onlineUsers=_useState6[0],setOnlineUsers=_useState6[1];var socket=useRef();useEffect(function(){socket.current=io('ws://localhost:4000');},[]);useEffect(function(){return function(){socket.current.disconnect();};},[]);useEffect(function(){socket.current.emit('addUser',currentUser===null||currentUser===void 0?void 0:currentUser._id);socket.current.on('getUsers',function(users){setOnlineUsers(users.filter(function(u){return u.userId!==(currentUser===null||currentUser===void 0?void 0:currentUser._id);}));});},[currentUser]);useEffect(function(){setFollowed(currentUser.followings.includes(user===null||user===void 0?void 0:user._id));var getFriends=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var friendList;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/users/friends/'+(user===null||user===void 0?void 0:user._id));case 3:friendList=_context.sent;setFriends(friendList.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getFriends(){return _ref2.apply(this,arguments);};}();getFriends();},[user]);var handleClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:try{if(followed){axios.put(\"/users/\".concat(user._id,\"/unfollow\"),{userId:currentUser._id});dispatch({type:'UNFOLLOW',payload:user._id});}else{axios.put(\"/users/\".concat(user._id,\"/follow\"),{userId:currentUser._id});dispatch({type:'FOLLOW',payload:user._id});}setFollowed(!followed);}catch(err){}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function handleClick(){return _ref3.apply(this,arguments);};}();var HomeRightbar=function HomeRightbar(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"birthdayContainer\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"birthdayImg\",src:\"assets/gift.png\",alt:\"\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"birthdayText\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Jane Doe\"}),\" and \",/*#__PURE__*/_jsx(\"b\",{children:\"3 other friends\"}),\" have a birhday today.\"]})]}),/*#__PURE__*/_jsx(\"a\",{href:\"https://www.lamborghini.com/en-en\",target:\"_blank\",children:/*#__PURE__*/_jsx(\"img\",{className:\"rightbarAd\",src:\"https://cdnb.artstation.com/p/assets/images/images/005/047/357/large/allan-portilho-e89c6d32864153-56968c9449fea.jpg?1488129679\"})}),/*#__PURE__*/_jsx(\"h4\",{className:\"rightbarTitle\",children:\"Online Friends\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"rightbarFriendList\",children:onlineUsers===null||onlineUsers===void 0?void 0:onlineUsers.map(function(u){return/*#__PURE__*/_jsx(Link,{to:\"/chat\",style:{textDecoration:'none',color:'black'},children:/*#__PURE__*/_jsx(Online,{userId:u.userId})},u.userId);})})]});};var ProfileRightbar=function ProfileRightbar(){return/*#__PURE__*/_jsxs(_Fragment,{children:[user.username!==currentUser.username&&/*#__PURE__*/_jsxs(\"button\",{className:\"rightbarFollowButton\",onClick:handleClick,children:[followed?'Unfollow':'Follow',!followed?/*#__PURE__*/_jsx(AddIcon,{}):/*#__PURE__*/_jsx(RemoveIcon,{})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"rightbarTitle\",children:\"User information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfo\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfoItem\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoKey\",children:\"City:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoValue\",children:user.city})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfoItem\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoKey\",children:\"From:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoValue\",children:user.from})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfoItem\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoKey\",children:\"Relationship:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoValue\",children:user.relationship?user.relationship:'-'})]})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"rightbarTitle\",children:\"User friends\"}),/*#__PURE__*/_jsx(\"div\",{className:\"rightbarFollowings\",children:friends.map(function(friend){return/*#__PURE__*/_jsx(Link,{to:'/profile/'+friend.username,style:{textDecoration:'none'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarFollowing\",children:[/*#__PURE__*/_jsx(\"img\",{src:friend.profilePicture?PF+friend.profilePicture:PF+'person/noAvatar.png',alt:\"\",className:\"rightbarFollowingImg\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarFollowingName\",children:friend.username})]})},friend._id);})})]});};return/*#__PURE__*/_jsx(\"div\",{className:\"rightbar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rightbarWrapper\",children:user?/*#__PURE__*/_jsx(ProfileRightbar,{}):/*#__PURE__*/_jsx(HomeRightbar,{})})});}","map":{"version":3,"names":["Online","useContext","useEffect","useRef","useState","axios","Link","AuthContext","AddIcon","RemoveIcon","io","Rightbar","user","PF","process","env","REACT_APP_PUBLIC_FOLDER","friends","setFriends","currentUser","dispatch","followed","setFollowed","onlineUsers","setOnlineUsers","socket","current","disconnect","emit","_id","on","users","filter","u","userId","followings","includes","getFriends","get","friendList","data","console","log","handleClick","put","type","payload","err","HomeRightbar","map","textDecoration","color","ProfileRightbar","username","city","from","relationship","friend","profilePicture"],"sources":["C:/Users/AKAKI/SocialMedia/client/src/components/rightbar/Rightbar.jsx"],"sourcesContent":["import './rightbar.css';\r\nimport Online from '../online/Online';\r\nimport { useContext, useEffect, useRef, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport AddIcon from '@mui/icons-material/Add';\r\nimport RemoveIcon from '@mui/icons-material/Remove';\r\nimport { io } from 'socket.io-client';\r\n\r\nexport default function Rightbar({ user }) {\r\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\r\n  const [friends, setFriends] = useState([]);\r\n  const { user: currentUser, dispatch } = useContext(AuthContext);\r\n  const [followed, setFollowed] = useState(false);\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const socket = useRef();\r\n\r\n  useEffect(() => {\r\n    socket.current = io('ws://localhost:4000');\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      socket.current.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    socket.current.emit('addUser', currentUser?._id);\r\n    socket.current.on('getUsers', (users) => {\r\n      setOnlineUsers(users.filter((u) => u.userId !== currentUser?._id));\r\n    });\r\n  }, [currentUser]);\r\n\r\n  useEffect(() => {\r\n    setFollowed(currentUser.followings.includes(user?._id));\r\n    const getFriends = async () => {\r\n      try {\r\n        const friendList = await axios.get('/users/friends/' + user?._id);\r\n        setFriends(friendList.data);\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n    getFriends();\r\n  }, [user]);\r\n\r\n  const handleClick = async () => {\r\n    try {\r\n      if (followed) {\r\n        axios.put(`/users/${user._id}/unfollow`, {\r\n          userId: currentUser._id,\r\n        });\r\n        dispatch({ type: 'UNFOLLOW', payload: user._id });\r\n      } else {\r\n        axios.put(`/users/${user._id}/follow`, {\r\n          userId: currentUser._id,\r\n        });\r\n        dispatch({ type: 'FOLLOW', payload: user._id });\r\n      }\r\n      setFollowed(!followed);\r\n    } catch (err) {}\r\n  };\r\n\r\n  const HomeRightbar = () => {\r\n    return (\r\n      <>\r\n        <div className='birthdayContainer'>\r\n          <img className='birthdayImg' src='assets/gift.png' alt='' />\r\n          <span className='birthdayText'>\r\n            <b>Jane Doe</b> and <b>3 other friends</b> have a birhday today.\r\n          </span>\r\n        </div>\r\n        <a href='https://www.lamborghini.com/en-en' target='_blank'>\r\n          <img\r\n            className='rightbarAd'\r\n            src='https://cdnb.artstation.com/p/assets/images/images/005/047/357/large/allan-portilho-e89c6d32864153-56968c9449fea.jpg?1488129679'\r\n          />\r\n        </a>\r\n        <h4 className='rightbarTitle'>Online Friends</h4>\r\n        <ul className='rightbarFriendList'>\r\n          {onlineUsers?.map((u) => (\r\n            <Link\r\n              to='/chat'\r\n              key={u.userId}\r\n              style={{ textDecoration: 'none', color: 'black' }}\r\n            >\r\n              <Online userId={u.userId} />\r\n            </Link>\r\n          ))}\r\n        </ul>\r\n      </>\r\n    );\r\n  };\r\n\r\n  const ProfileRightbar = () => {\r\n    return (\r\n      <>\r\n        {user.username !== currentUser.username && (\r\n          <button className='rightbarFollowButton' onClick={handleClick}>\r\n            {followed ? 'Unfollow' : 'Follow'}\r\n            {!followed ? <AddIcon /> : <RemoveIcon />}\r\n          </button>\r\n        )}\r\n        <h4 className='rightbarTitle'>User information</h4>\r\n        <div className='rightbarInfo'>\r\n          <div className='rightbarInfoItem'>\r\n            <span className='rightbarInfoKey'>City:</span>\r\n            <span className='rightbarInfoValue'>{user.city}</span>\r\n          </div>\r\n          <div className='rightbarInfoItem'>\r\n            <span className='rightbarInfoKey'>From:</span>\r\n            <span className='rightbarInfoValue'>{user.from}</span>\r\n          </div>\r\n          <div className='rightbarInfoItem'>\r\n            <span className='rightbarInfoKey'>Relationship:</span>\r\n            <span className='rightbarInfoValue'>\r\n              {user.relationship ? user.relationship : '-'}\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <h4 className='rightbarTitle'>User friends</h4>\r\n        <div className='rightbarFollowings'>\r\n          {friends.map((friend) => (\r\n            <Link\r\n              to={'/profile/' + friend.username}\r\n              style={{ textDecoration: 'none' }}\r\n              key={friend._id}\r\n            >\r\n              <div className='rightbarFollowing'>\r\n                <img\r\n                  src={\r\n                    friend.profilePicture\r\n                      ? PF + friend.profilePicture\r\n                      : PF + 'person/noAvatar.png'\r\n                  }\r\n                  alt=''\r\n                  className='rightbarFollowingImg'\r\n                />\r\n                <span className='rightbarFollowingName'>{friend.username}</span>\r\n              </div>\r\n            </Link>\r\n          ))}\r\n        </div>\r\n      </>\r\n    );\r\n  };\r\n  return (\r\n    <div className='rightbar'>\r\n      <div className='rightbarWrapper'>\r\n        {user ? <ProfileRightbar /> : <HomeRightbar />}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}